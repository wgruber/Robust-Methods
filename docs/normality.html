<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Normality | Robuste Methoden</title>
  <meta name="description" content="Maximize Accuracy and Power of Research" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Normality | Robuste Methoden" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/Images/Cover.png" />
  <meta property="og:description" content="Maximize Accuracy and Power of Research" />
  <meta name="github-repo" content="wgruber/RobustMethods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Normality | Robuste Methoden" />
  
  <meta name="twitter:description" content="Maximize Accuracy and Power of Research" />
  <meta name="twitter:image" content="/Images/Cover.png" />

<meta name="author" content="Walter Gruber" />


<meta name="date" content="2025-03-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="critical-assumptions.html"/>
<link rel="next" href="myth-and-misconceptions-about-robustness.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#roadmap"><i class="fa fa-check"></i>Roadmap</a></li>
</ul></li>
<li class="part"><span><b>PART I: GLM-Assumptions</b></span></li>
<li class="chapter" data-level="" data-path="critical-assumptions.html"><a href="critical-assumptions.html"><i class="fa fa-check"></i>Critical Assumptions</a></li>
<li class="chapter" data-level="" data-path="normality.html"><a href="normality.html"><i class="fa fa-check"></i>Normality</a>
<ul>
<li class="chapter" data-level="" data-path="normality.html"><a href="normality.html#contaminated-normal-distributions"><i class="fa fa-check"></i>Contaminated Normal distributions</a></li>
<li class="chapter" data-level="" data-path="normality.html"><a href="normality.html#issues-with-normality"><i class="fa fa-check"></i>Issues with normality</a>
<ul>
<li class="chapter" data-level="" data-path="normality.html"><a href="normality.html#residuals"><i class="fa fa-check"></i>Residuals</a></li>
<li class="chapter" data-level="" data-path="normality.html"><a href="normality.html#test-statistics"><i class="fa fa-check"></i>Test statistics</a></li>
<li class="chapter" data-level="" data-path="normality.html"><a href="normality.html#confidence-intervalls"><i class="fa fa-check"></i>Confidence intervalls</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="myth-and-misconceptions-about-robustness.html"><a href="myth-and-misconceptions-about-robustness.html"><i class="fa fa-check"></i>Myth and misconceptions about robustness</a>
<ul>
<li class="chapter" data-level="" data-path="myth-and-misconceptions-about-robustness.html"><a href="myth-and-misconceptions-about-robustness.html#are-glms-robust"><i class="fa fa-check"></i>Are GLM’s robust?</a></li>
<li class="chapter" data-level="" data-path="myth-and-misconceptions-about-robustness.html"><a href="myth-and-misconceptions-about-robustness.html#validity-of-central-limit-theorem"><i class="fa fa-check"></i>Validity of central limit theorem</a></li>
</ul></li>
<li class="part"><span><b>PART II: Robust Methods</b></span></li>
<li class="chapter" data-level="" data-path="definition-of-robust.html"><a href="definition-of-robust.html"><i class="fa fa-check"></i>Definition of Robust</a></li>
<li class="chapter" data-level="" data-path="solutions-to-violated-assumptions.html"><a href="solutions-to-violated-assumptions.html"><i class="fa fa-check"></i>Solutions to violated assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="solutions-to-violated-assumptions.html"><a href="solutions-to-violated-assumptions.html#alternative-estimators"><i class="fa fa-check"></i>Alternative estimators</a></li>
<li class="chapter" data-level="" data-path="solutions-to-violated-assumptions.html"><a href="solutions-to-violated-assumptions.html#transformation-of-data"><i class="fa fa-check"></i>Transformation of data</a></li>
<li class="chapter" data-level="" data-path="solutions-to-violated-assumptions.html"><a href="solutions-to-violated-assumptions.html#nonparametric-tests"><i class="fa fa-check"></i>Nonparametric tests</a></li>
<li class="chapter" data-level="" data-path="solutions-to-violated-assumptions.html"><a href="solutions-to-violated-assumptions.html#robust-methods"><i class="fa fa-check"></i>Robust methods</a></li>
<li class="chapter" data-level="" data-path="solutions-to-violated-assumptions.html"><a href="solutions-to-violated-assumptions.html#adjusting-the-standard-errors"><i class="fa fa-check"></i>Adjusting the standard errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selected-robust-measures-of-location.html"><a href="selected-robust-measures-of-location.html"><i class="fa fa-check"></i>Selected Robust measures of location</a>
<ul>
<li class="chapter" data-level="" data-path="selected-robust-measures-of-location.html"><a href="selected-robust-measures-of-location.html#trimmed-mean"><i class="fa fa-check"></i>Trimmed mean</a></li>
<li class="chapter" data-level="" data-path="selected-robust-measures-of-location.html"><a href="selected-robust-measures-of-location.html#winsorized-mean"><i class="fa fa-check"></i>Winsorized mean</a>
<ul>
<li class="chapter" data-level="" data-path="selected-robust-measures-of-location.html"><a href="selected-robust-measures-of-location.html#winsorization-round-up"><i class="fa fa-check"></i>Winsorization Round-Up</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selected-robust-measures-of-location.html"><a href="selected-robust-measures-of-location.html#m-estimators"><i class="fa fa-check"></i>M-estimators</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="measures-of-scale.html"><a href="measures-of-scale.html"><i class="fa fa-check"></i>Measures of Scale</a></li>
<li class="part"><span><b>PART III: R-Examples</b></span></li>
<li class="chapter" data-level="" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i>R-Packages</a>
<ul>
<li class="chapter" data-level="" data-path="r-packages.html"><a href="r-packages.html#other-packages-in-r"><i class="fa fa-check"></i>Other Packages in R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="two-independent-means.html"><a href="two-independent-means.html"><i class="fa fa-check"></i>Two independent means</a>
<ul>
<li class="chapter" data-level="" data-path="two-independent-means.html"><a href="two-independent-means.html#standard-t-test"><i class="fa fa-check"></i>Standard t-Test</a></li>
<li class="chapter" data-level="" data-path="two-independent-means.html"><a href="two-independent-means.html#robust-t-test"><i class="fa fa-check"></i>Robust t-Test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i>One-way ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="one-way-anova.html"><a href="one-way-anova.html#standard-anova"><i class="fa fa-check"></i>Standard ANOVA</a></li>
<li class="chapter" data-level="" data-path="one-way-anova.html"><a href="one-way-anova.html#robust-one-way-anova"><i class="fa fa-check"></i>Robust One-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="two-dependent-means.html"><a href="two-dependent-means.html"><i class="fa fa-check"></i>Two dependent means</a>
<ul>
<li class="chapter" data-level="" data-path="two-dependent-means.html"><a href="two-dependent-means.html#check-assumptions"><i class="fa fa-check"></i>Check Assumptions</a></li>
<li class="chapter" data-level="" data-path="two-dependent-means.html"><a href="two-dependent-means.html#standard-t-test-1"><i class="fa fa-check"></i>Standard t-Test</a></li>
<li class="chapter" data-level="" data-path="two-dependent-means.html"><a href="two-dependent-means.html#robust-t-test-1"><i class="fa fa-check"></i>Robust t-Test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="one-way-rm-anova.html"><a href="one-way-rm-anova.html"><i class="fa fa-check"></i>One-way RM-ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="one-way-rm-anova.html"><a href="one-way-rm-anova.html#check-assumptions-1"><i class="fa fa-check"></i>Check Assumptions</a></li>
<li class="chapter" data-level="" data-path="one-way-rm-anova.html"><a href="one-way-rm-anova.html#standard-rm-anova"><i class="fa fa-check"></i>Standard RM-ANOVA</a></li>
<li class="chapter" data-level="" data-path="one-way-rm-anova.html"><a href="one-way-rm-anova.html#robust-anova"><i class="fa fa-check"></i>Robust ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regression-models.html"><a href="regression-models.html"><i class="fa fa-check"></i>Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="regression-models.html"><a href="regression-models.html#check-data"><i class="fa fa-check"></i>Check Data</a></li>
<li class="chapter" data-level="" data-path="regression-models.html"><a href="regression-models.html#standard-linear-model"><i class="fa fa-check"></i>Standard Linear Model</a></li>
<li class="chapter" data-level="" data-path="regression-models.html"><a href="regression-models.html#robust-linear-model-rlm"><i class="fa fa-check"></i>Robust Linear Model (RLM)</a>
<ul>
<li class="chapter" data-level="" data-path="regression-models.html"><a href="regression-models.html#rlm-extended"><i class="fa fa-check"></i>RLM-Extended</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>PART IV: Summary</b></span></li>
<li class="chapter" data-level="" data-path="conclusions-and-recommendations.html"><a href="conclusions-and-recommendations.html"><i class="fa fa-check"></i>Conclusions and recommendations</a>
<ul>
<li class="chapter" data-level="" data-path="conclusions-and-recommendations.html"><a href="conclusions-and-recommendations.html#recommendations"><i class="fa fa-check"></i>Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referenzen.html"><a href="referenzen.html"><i class="fa fa-check"></i>Referenzen</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Robuste Methoden</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="normality" class="section level1 unnumbered hasAnchor">
<h1>Normality<a href="normality.html#normality" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Before looking into different problems with normality we shall have a closer look at distributions which seem to be normal but aren’t!</p>
<div id="contaminated-normal-distributions" class="section level2 unnumbered hasAnchor">
<h2>Contaminated Normal distributions<a href="normality.html#contaminated-normal-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we dig into some details let us illustrate the effects of slight depatures form normality. Suppose we sample (an arbitrary variable) from the population of all adults. Within this sample about 10% are of age 70 and over. Let us assume, that the people younger than 70 have a mean <span class="math inline">\(\bar{x}_Y = 0\)</span> and a standard deviation of <span class="math inline">\(sd_Y = 1\)</span>. The older people also show a mean of <span class="math inline">\(\bar{x}_O = 0\)</span>, but there standard deviation is much higher, e.g. <span class="math inline">\(sd_O = 10\)</span>. The following graph shows the standard normal distribution (<em>black</em>) vs. the mixed distribution of our example (<span style="color:blue"><em>blue</em></span>). Again, only 10% of the data for this distribution has a different variance (<span style="color:red"><em>red</em></span>). Do you think these distributions can be considered identical, or at least both of them are normally distributed?</p>
<center>
<div class="float">
<img src="Images/Wilcox-2-Contaminated-Full-Plot.jpg" style="width:50.0%" alt="The black curve shows the standard normal distrubution (N(0,1)). The blue curve shows a small sample (10% of the sample size) with N(0,10). The red curve shows the mixed (contaminated) normal distribution. Note the slight difference in the tails of the distribution. The mixed distribution is heavy tailed." />
<div class="figcaption">The black curve shows the standard normal distrubution (<span class="math inline">\(N(0,1)\)</span>). The blue curve shows a small sample (10% of the sample size) with <span class="math inline">\(N(0,10)\)</span>. The red curve shows the mixed (contaminated) normal distribution. Note the slight difference in the tails of the distribution. The mixed distribution is <em>heavy tailed</em>.</div>
</div>
</center>
<p>If we observe such results on representative samples, we could assume, that the entire population has a <em>mixed</em>, or <em>contaminated distribution</em> with <span class="math inline">\(\varepsilon = 0.1\)</span> and <span class="math inline">\(\lambda = 10\)</span>. So, in a formal way we would define two independent distributions (<span class="math inline">\(X, Y\)</span>) with different standard deviations and different sample sizes which are mixed in a distribution <span class="math inline">\(H\)</span> with the variance of <span class="math inline">\(Var(H)\)</span>, such that:</p>
<p><span class="math display">\[\begin{array}{l}
  X            &amp;\approx N(\mu = 0, sd = 1) \\
  Y            &amp;\approx N(\mu = 0, sd = \lambda) = N(\mu = 0, sd = 10) \\
  H            &amp;= (1-\varepsilon) \cdot X + \varepsilon \cdot (x)  = 0.9 \cdot X + 0.1 \cdot Y\\
  \overline{H} &amp;= E(H) = 0 \\
  Var(H)       &amp;= E(H^2) \\
  E(H^2)       &amp; = E(0.9 \cdot X^2 + 0.1 \cdot Y^2 + 2 \cdot X \cdot Y \cdot 0.9 \cdot 0.1) \\
               &amp;=  0.9 \cdot \underbrace{E(X^2)}_{=1^2} + 0.1 \cdot \underbrace{E(Y^2)}_{=10^2} + 2 \cdot 0.9 \cdot 0.1 \cdot \underbrace{E(X \cdot Y)}_{\text{= Cov(X,Y)=0}} \\
               &amp;=  0.9 \cdot 1 + 0.1 \cdot 100 = 10.9
\end{array}\]</span></p>
<p>If we look at the distribution plots, we notice that both (standard normal and contaminated normal) both look very similar. We could conclude, that the contaminated normal is approximating the standard normal distribution to such extent, that we can assume it is also a normal distribution.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="normality.html#cb1-1" tabindex="-1"></a>  xfrom  <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb1-2"><a href="normality.html#cb1-2" tabindex="-1"></a>  xto    <span class="ot">&lt;-</span> <span class="sc">+</span><span class="dv">3</span></span>
<span id="cb1-3"><a href="normality.html#cb1-3" tabindex="-1"></a>  Mu     <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-4"><a href="normality.html#cb1-4" tabindex="-1"></a>  SD     <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-5"><a href="normality.html#cb1-5" tabindex="-1"></a>  Epsilon  <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># percentage of smaller sample with higher std</span></span>
<span id="cb1-6"><a href="normality.html#cb1-6" tabindex="-1"></a>  Lambda <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># standard deviataion of smaller sample</span></span>
<span id="cb1-7"><a href="normality.html#cb1-7" tabindex="-1"></a>  <span class="co"># x      &lt;- seq(from = xfrom * Lambda, to = xto * Lambda, by = 0.1)</span></span>
<span id="cb1-8"><a href="normality.html#cb1-8" tabindex="-1"></a>  x      <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> xfrom, <span class="at">to =</span> xto, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb1-9"><a href="normality.html#cb1-9" tabindex="-1"></a>  N      <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb1-10"><a href="normality.html#cb1-10" tabindex="-1"></a>  Y1     <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1-11"><a href="normality.html#cb1-11" tabindex="-1"></a>  Y2     <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1-12"><a href="normality.html#cb1-12" tabindex="-1"></a>  <span class="co"># Y3     &lt;- NULL</span></span>
<span id="cb1-13"><a href="normality.html#cb1-13" tabindex="-1"></a>  CN     <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1-14"><a href="normality.html#cb1-14" tabindex="-1"></a>  </span>
<span id="cb1-15"><a href="normality.html#cb1-15" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb1-16"><a href="normality.html#cb1-16" tabindex="-1"></a>    Y1[i]    <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x[i], <span class="at">mean =</span> Mu, <span class="at">sd =</span> SD) <span class="co"># std. normal component</span></span>
<span id="cb1-17"><a href="normality.html#cb1-17" tabindex="-1"></a>    Y2[i]    <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x[i], <span class="at">mean =</span> Mu, <span class="at">sd =</span> SD<span class="sc">*</span>Lambda) <span class="co"># contamination</span></span>
<span id="cb1-18"><a href="normality.html#cb1-18" tabindex="-1"></a>    <span class="co"># Y2[i]    &lt;- dnorm(x[i]/Lambda, mean = Mu, sd = SD) # contamination (same as above)</span></span>
<span id="cb1-19"><a href="normality.html#cb1-19" tabindex="-1"></a>    CN[i] <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> Epsilon) <span class="sc">*</span> Y1[i]) <span class="sc">+</span> (Epsilon <span class="sc">*</span> Y2[i])</span>
<span id="cb1-20"><a href="normality.html#cb1-20" tabindex="-1"></a>  }</span>
<span id="cb1-21"><a href="normality.html#cb1-21" tabindex="-1"></a>  DF_CN  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">xAxis =</span> x, <span class="at">Standard =</span> Y1, <span class="at">Contaminated =</span> Y2, <span class="at">Mixed =</span> CN)</span>
<span id="cb1-22"><a href="normality.html#cb1-22" tabindex="-1"></a>    <span class="co"># probability density function (pdf) for one input z-value to</span></span>
<span id="cb1-23"><a href="normality.html#cb1-23" tabindex="-1"></a>    <span class="co"># show the equivalence to the dnorm() function for the same parameters mean</span></span>
<span id="cb1-24"><a href="normality.html#cb1-24" tabindex="-1"></a>    <span class="co"># and sd.</span></span>
<span id="cb1-25"><a href="normality.html#cb1-25" tabindex="-1"></a>    <span class="co"># stddev &lt;- 1</span></span>
<span id="cb1-26"><a href="normality.html#cb1-26" tabindex="-1"></a>    <span class="co"># zwert  &lt;- -3</span></span>
<span id="cb1-27"><a href="normality.html#cb1-27" tabindex="-1"></a>    <span class="co"># Phi &lt;- (1/sqrt(2*pi*stddev^2)) * exp(-0.5*(zwert/stddev)^2)</span></span>
<span id="cb1-28"><a href="normality.html#cb1-28" tabindex="-1"></a>    <span class="co"># Y1[1] == Phi</span></span>
<span id="cb1-29"><a href="normality.html#cb1-29" tabindex="-1"></a>  <span class="co"># ggplot(DF_CN, aes(x = xAxis)) + </span></span>
<span id="cb1-30"><a href="normality.html#cb1-30" tabindex="-1"></a>  <span class="co">#   geom_line(aes(y = Standard), color = &quot;red&quot;) + </span></span>
<span id="cb1-31"><a href="normality.html#cb1-31" tabindex="-1"></a>  <span class="co">#   geom_line(aes(y = Contaminated), color = &quot;blue&quot;) + </span></span>
<span id="cb1-32"><a href="normality.html#cb1-32" tabindex="-1"></a>  <span class="co">#   geom_line(aes(y = Mixed), color=&quot;black&quot;, linetype=&quot;twodash&quot;) </span></span>
<span id="cb1-33"><a href="normality.html#cb1-33" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb1-34"><a href="normality.html#cb1-34" tabindex="-1"></a>  <span class="co"># library(tidyverse)</span></span>
<span id="cb1-35"><a href="normality.html#cb1-35" tabindex="-1"></a>  DF_CN_P1 <span class="ot">&lt;-</span> DF_CN <span class="sc">%&gt;%</span> </span>
<span id="cb1-36"><a href="normality.html#cb1-36" tabindex="-1"></a>              <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;Distribution&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Value&quot;</span>, <span class="sc">-</span>xAxis)</span>
<span id="cb1-37"><a href="normality.html#cb1-37" tabindex="-1"></a>  <span class="co"># head(DF_CN_P1)</span></span>
<span id="cb1-38"><a href="normality.html#cb1-38" tabindex="-1"></a>  P1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(DF_CN_P1, <span class="fu">aes</span>(<span class="at">x =</span> xAxis, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb1-39"><a href="normality.html#cb1-39" tabindex="-1"></a>        <span class="co"># geom_line(aes(color = Distribution, linetype = Distribution), size = 1.3) + </span></span>
<span id="cb1-40"><a href="normality.html#cb1-40" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Distribution), <span class="at">size =</span> <span class="fl">1.3</span>) <span class="sc">+</span> </span>
<span id="cb1-41"><a href="normality.html#cb1-41" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1-42"><a href="normality.html#cb1-42" tabindex="-1"></a>        <span class="fu">theme_bw</span>()</span>
<span id="cb1-43"><a href="normality.html#cb1-43" tabindex="-1"></a>  DF_CN_P1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(DF_CN_P1, Distribution <span class="sc">==</span> <span class="st">&quot;Standard&quot;</span> <span class="sc">|</span> Distribution <span class="sc">==</span> <span class="st">&quot;Mixed&quot;</span>)</span>
<span id="cb1-44"><a href="normality.html#cb1-44" tabindex="-1"></a>  P2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(DF_CN_P1, <span class="fu">aes</span>(<span class="at">x =</span> xAxis, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb1-45"><a href="normality.html#cb1-45" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Distribution), <span class="at">size =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb1-46"><a href="normality.html#cb1-46" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1-47"><a href="normality.html#cb1-47" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>Even so they look like almost identical, they are NOT! Notice the very slight difference at the left and right side (the tails) of the distribution. It might seem just a slight difference, but has in fact a quite dramatic impact on the variance. The variance for the standard normal (black) is 1, whereas for the combined normal (red) the variance is at 10.9 (c.f. to our results above)! We can simulate this effect quite easy - just copy and paste the following code and compare the results:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="normality.html#cb2-1" tabindex="-1"></a>  NSim <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb2-2"><a href="normality.html#cb2-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">143</span>)</span>
<span id="cb2-3"><a href="normality.html#cb2-3" tabindex="-1"></a>  Y3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(NSim, <span class="at">mean =</span> Mu, <span class="at">sd =</span> SD)</span>
<span id="cb2-4"><a href="normality.html#cb2-4" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3143</span>)</span>
<span id="cb2-5"><a href="normality.html#cb2-5" tabindex="-1"></a>  Y4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(NSim, <span class="at">mean =</span> Mu, <span class="at">sd =</span> SD <span class="sc">*</span> Lambda)</span>
<span id="cb2-6"><a href="normality.html#cb2-6" tabindex="-1"></a>  z  <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb2-7"><a href="normality.html#cb2-7" tabindex="-1"></a>               <span class="at">size    =</span> NSim,</span>
<span id="cb2-8"><a href="normality.html#cb2-8" tabindex="-1"></a>               <span class="at">prob    =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>Epsilon, Epsilon),</span>
<span id="cb2-9"><a href="normality.html#cb2-9" tabindex="-1"></a>               <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-10"><a href="normality.html#cb2-10" tabindex="-1"></a>  Hx            <span class="ot">&lt;-</span> Y3 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>z) <span class="sc">+</span> Y4 <span class="sc">*</span> z</span>
<span id="cb2-11"><a href="normality.html#cb2-11" tabindex="-1"></a>  DF_Sim        <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Standard =</span> Y3, <span class="at">Contaminated =</span> Y4, <span class="at">Mixed =</span> Hx)</span>
<span id="cb2-12"><a href="normality.html#cb2-12" tabindex="-1"></a>  DF_Sim_L      <span class="ot">&lt;-</span> DF_Sim <span class="sc">%&gt;%</span> <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;Distribution&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb2-13"><a href="normality.html#cb2-13" tabindex="-1"></a>  Res           <span class="ot">&lt;-</span> <span class="fu">summary_by</span>(DF_Sim_L,Value <span class="sc">~</span> Distribution, <span class="at">FUN =</span> <span class="fu">c</span>(mean, var))</span>
<span id="cb2-14"><a href="normality.html#cb2-14" tabindex="-1"></a>  <span class="fu">colnames</span>(Res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Distribution&quot;</span>, <span class="st">&quot;Means&quot;</span>, <span class="st">&quot;Variances&quot;</span>)</span>
<span id="cb2-15"><a href="normality.html#cb2-15" tabindex="-1"></a>  Res[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]     <span class="ot">&lt;-</span> <span class="fu">round</span>(Res[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>)</span>
<span id="cb2-16"><a href="normality.html#cb2-16" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(Res, <span class="at">caption =</span> <span class="st">&quot;Results of the simulation. Note the huge difference in the standard and mixed distribution.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:Wilcox-2-Simiulation">Table 1: </span>Results of the simulation. Note the huge difference in the standard and mixed distribution.</caption>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="right">Means</th>
<th align="right">Variances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Contaminated</td>
<td align="right">0.03</td>
<td align="right">100.81</td>
</tr>
<tr class="even">
<td align="left">Mixed</td>
<td align="right">-0.03</td>
<td align="right">10.87</td>
</tr>
<tr class="odd">
<td align="left">Standard</td>
<td align="right">-0.01</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
<blockquote>
<p>In essence, a small proportion of the population of participants can have an inordinately large effect on its value.</p>
</blockquote>
<p>A look at the Q-Q-plot reveals the problem of the mixed distribution in a quite impressive way:</p>
<!-- ```{r Wilcox-2-QQPlot, echo = FALSE, eval = TRUE, error=FALSE, message=FALSE, warning=FALSE, fig.align='center'} -->
<!-- ``` -->
<center>
<div class="float">
<img src="Images/Wilcox-2-QQ-Plot.jpg" style="width:80.0%" alt="Q-Q-Plot of standard vs. mixed normal (later is also reffered to as contaminated normal)" />
<div class="figcaption">Q-Q-Plot of standard vs. mixed normal (later is also reffered to as contaminated normal)</div>
</div>
</center>
</div>
<div id="issues-with-normality" class="section level2 unnumbered hasAnchor">
<h2>Issues with normality<a href="normality.html#issues-with-normality" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are three issues related to normality:</p>
<ol style="list-style-type: decimal">
<li>normality of residuals (<span class="math inline">\(\varepsilon_i\)</span>)</li>
<li>Normal distribution of test statistics</li>
<li>Confidence intervals</li>
</ol>
<div id="residuals" class="section level3 unnumbered hasAnchor">
<h3>Residuals<a href="normality.html#residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- Field/Wilcox-2017 2.2 on page 20 -->
<p>The well known (simple) regression model in its mathematical form is defined as:</p>
<p><span class="math display">\[\begin{equation}
  Y_i = b_0 + X_i \cdot b_1 + \varepsilon_i
\end{equation}\]</span></p>
<p>Each case (<span class="math inline">\(i\)</span>) of data (<span class="math inline">\(X_i\)</span>) has a residual <span class="math inline">\(\varepsilon_i\)</span>, which is the difference between the predicted and observed values of the outcome. If you inspected a histogram of these residuals for all cases, you would hope to see a normal distribution centered around 0, i.e. <span class="math inline">\(\bar{\varepsilon}_i = 0\)</span>.</p>
<p>A mean residual of <span class="math inline">\(\bar{\varepsilon}_i = 0\)</span> means that the model (on average) correctly predicts the outcome value. In other words, if the residual is zero (or close to it) for most cases, then the error in prediction is zero (or close to it) for most cases.</p>
<p>If the model fits well, we might also expect that very extreme over-, or underestimations occur rarely. A well fitting model then would yield residuals that, like a normal distribution, are most frequent around zero and very infrequent at extreme values. This description explains what we mean by normality of residuals.</p>
<blockquote>
<p>It also gives an idea of what it means if the normality of residuals is not given!</p>
</blockquote>
</div>
<div id="test-statistics" class="section level3 unnumbered hasAnchor">
<h3>Test statistics<a href="normality.html#test-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <span class="math inline">\(p\)</span>-values associated with the parameter estimates of the model are based on the assumption that the test statistic associated with them follows a normal distribution (or some variant of it such as the <span class="math inline">\(t\)</span>-distribution).</p>
<p>Essentially, to test the hypothesis that the parameter estimate (<span class="math inline">\(\bar{x}, r, \hat{b}_k\)</span>, etc.) is not equal to 0 (= <span class="math inline">\(H_0\)</span>) it is necessary to assume a particular shape for the null distribution of the test statistic (i.e., normal).</p>
<p>If the sampling distribution of the test statistic turns out not to be the assumed shape (i.e. normal) then the resulting <span class="math inline">\(p\)</span>-values will be incorrect.</p>
<blockquote>
<p>As a reminder: the <span class="math inline">\(p\)</span>-value tells us about the probability to observe such data as our sample, IF the Null-Hyothesis (<span class="math inline">\(H_0\)</span>) is True, i.e. <span class="math inline">\(p(D|H_0)\)</span>! For the <span class="math inline">\(H_0\)</span> we (often) assume a normal distribution (or a deriviate of a normal, such as <span class="math inline">\(\chi^2, F, t\)</span>).</p>
</blockquote>
</div>
<div id="confidence-intervalls" class="section level3 unnumbered hasAnchor">
<h3>Confidence intervalls<a href="normality.html#confidence-intervalls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The bounds of confidence intervals for parameter estimates are constructed by adding or subtracting from the estimate the associated standard error multiplied by the quantile of a null distribution associated with the probability level assigned to the interval.</p>
<p><span class="math display">\[\begin{array}{ccc}
  CI_{Mean} &amp; = &amp; \bar{x} \pm SE_{Mean} \cdot t_{crit}\\
  CI_{Corr} &amp; = &amp; r \pm SE_{Corr} \cdot t_{crit}\\
  CI_{Coef} &amp; = &amp; \hat{b}_k \pm SE_{Coeff} \cdot t_{crit} \\
  CI_{...}  &amp; = &amp; \cdots \pm SE_{...} \cdot t_{crit}
\end{array}\]</span></p>
<p>For tests of parameters in the linear model, the null distribution is assumed to be normal. It is an example of a general strategy in inferential statistics to convert an estimator, such as the mean, into a standardized statistic (z) that is asymptotically standard normal. The general issue is one of determining under what circumstances assuming normality gives a reasonably accurate result.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="critical-assumptions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="myth-and-misconceptions-about-robustness.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
